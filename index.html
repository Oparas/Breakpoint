<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Breakpoint — Home</title>
  <style>
    :root{--bg:#0f1720;--card:#0b1020;--muted:#9aa4b2;--accent:#4f46e5;--accent2:#ec4899}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,Arial, sans-serif;background:var(--bg);color:#eef2ff}
    header{padding:18px;background:linear-gradient(90deg,var(--accent),var(--accent2));display:flex;align-items:center;gap:12px}
    header h1{margin:0;font-size:1.4rem}
    .container{max-width:1100px;margin:24px auto;padding:0 16px}
    /* Slider */
    .slider{position:relative;height:220px;border-radius:12px;overflow:hidden;background:#08101a;margin-bottom:18px}
    .slides{display:flex;height:100%;transition:transform .6s ease}
    .slide{min-width:100%;padding:20px;display:flex;gap:20px;align-items:center}
    .slide img{width:36%;border-radius:10px;object-fit:cover;box-shadow:0 8px 30px rgba(0,0,0,.6)}
    .slide .meta{flex:1}
    .slide h2{margin:0 0 8px 0}
    .slide p{margin:0;color:var(--muted)}
    .slider-controls{position:absolute;left:12px;right:12px;bottom:12px;display:flex;justify-content:center;gap:8px}
    .dot{width:10px;height:10px;border-radius:50%;background:rgba(255,255,255,.15);cursor:pointer}
    .dot.active{background:#fff}
    /* Search / filters */
    .filters{display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap}
    input,select,button{padding:10px;border-radius:8px;border:0;font-size:14px}
    input{flex:1;min-width:160px}
    button.primary{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff}
    /* Grid */
    .movies{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
    .card{background:var(--card);border-radius:10px;overflow:hidden;transition:transform .18s,box-shadow .18s}
    .card:hover{transform:translateY(-6px);box-shadow:0 10px 30px rgba(0,0,0,.6)}
    .poster{width:100%;height:280px;object-fit:cover;display:block}
    .card-body{padding:10px}
    .title{font-weight:600;margin:0 0 6px 0}
    .meta{color:var(--muted);font-size:13px;margin-bottom:8px}
    .btn-row{display:flex;gap:8px}
    .btn{flex:1;padding:8px;border-radius:8px;border:0;cursor:pointer}
    .btn.watch{background:var(--accent);color:#fff}
    .btn.disabled{background:#444;color:#aaa;cursor:not-allowed}
    .small{font-size:13px;color:var(--muted)}
    /* Modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);z-index:60;padding:20px}
    .modal.active{display:flex}
    .modal-card{background:#071020;width:100%;max-width:900px;border-radius:10px;overflow:hidden;position:relative}
    .modal-content{padding:12px}
    .close{position:absolute;right:12px;top:12px;background:var(--accent2);border:0;color:#000;padding:8px;border-radius:8px;cursor:pointer}
    /* watchlist badge */
    .watch-badge{background:#ffd24d;color:#000;padding:6px 8px;border-radius:999px;font-weight:600}
    /* responsive */
    @media (max-width:700px){ .slide img{display:none}.poster{height:180px} }
  </style>
</head>
<body>
  <header>
    <h1>Breakpoint</h1>
    <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
      <div id="watchlistCount" class="watch-badge" title="Watchlist">0</div>
    </div>
  </header>

  <div class="container">
    <!-- Slider -->
    <div class="slider" id="hero">
      <div class="slides" id="slides"></div>
      <div class="slider-controls" id="dots"></div>
    </div>

    <!-- Filters -->
    <div class="filters">
      <input id="q" placeholder="ค้นหาชื่อหนังหรือตอน..." />
      <select id="tagFilter"><option value="">ทุกประเภท</option></select>
      <button class="primary" onclick="clearFilters()">ล้าง</button>
    </div>

    <!-- Movies grid -->
    <div class="movies" id="movieGrid"></div>
  </div>

  <!-- Modal player / detail -->
  <div id="modal" class="modal" onclick="modalOutside(event)">
    <div class="modal-card" role="dialog" aria-modal="true" onclick="event.stopPropagation()">
      <button class="close" onclick="closeModal()">X</button>
      <div id="modalPlayerWrap">
        <!-- dynamic inserted player -->
      </div>
      <div class="modal-content" id="modalMeta"></div>
    </div>
  </div>

<script>
/* ====== Data ====== */
const movies = [
  { id:1, title:'Breakpoint ตอนที่1', year:2025, tags:['Action','สงครามส่งด่วน'], type:'file', src:'bp1.mp4', poster:'bp1.jpg', rating:4.3, desc:'ตอนเปิดเรื่อง ยานส่งด่วนชนิดพิเศษถูกจารกรรม...'},
  { id:2, title:'Breakpoint ตอนที่2', year:2025, tags:['Action','สงครามส่งด่วน'], type:'gdrive', src:'https://drive.google.com/file/d/1qq4ITXatn9NwlZXVSGQGGy3HruISSy-K/preview', poster:'bp2.jpg', rating:4.6, desc:'ความตึงเครียดเพิ่มขึ้นเมื่อทีมต้องเผชิญ...' },
  { id:3, title:'Breakpoint ตอนที่3', year:2025, tags:['Action','สงครามส่งด่วน'], type:'file', src:'bp3.mp4', poster:'bp3.jpg', rating:4.8, desc:'EP3 ปูบทสู่การต่อสู้ครั้งใหญ่', release:'2025-11-23' }
];

/* ====== UI refs ====== */
const slidesEl = document.getElementById('slides');
const dotsEl = document.getElementById('dots');
const movieGrid = document.getElementById('movieGrid');
const tagFilter = document.getElementById('tagFilter');
const q = document.getElementById('q');
const modal = document.getElementById('modal');
const modalPlayerWrap = document.getElementById('modalPlayerWrap');
const modalMeta = document.getElementById('modalMeta');
const watchlistCount = document.getElementById('watchlistCount');

/* ====== Watchlist (localStorage) ====== */
function loadWatchlist(){ try{return JSON.parse(localStorage.getItem('watchlist')||'[]')}catch(e){return []} }
function saveWatchlist(list){ localStorage.setItem('
